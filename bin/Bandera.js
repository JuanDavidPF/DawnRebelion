//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class Bandera {

    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


    constructor(app, x, y) {

        this.app = app;
        this.x = x;
        this.y = y;
        this.pos = this.app.createVector(this.x, this.y);
        this.vel = this.app.createVector(0, 0);
        this.acel = this.app.createVector(0, 0.34);

        if (this.x == 40) this.tipo = "Sign";
        if (this.x == 1551) this.tipo = "Flag";


        if (this.tipo == "Sign") this.poste = this.app.loadImage("./data/escenario/suelo/letrero.png");

        if (this.tipo == "Flag") {
            this.poste = [];
            for (let i = 0; i < 6; i++) {
                this.poste[i] = this.app.loadImage("./data/escenario/suelo/bandera" + (i + 1) + ".png");
            }
        }
        this.waves = 0;

        //dimensiones

        this.ancho = 20;
        this.alto = 100;

        //hilos

        this.fisicas = this.fisicas.bind(this);
        setInterval(this.fisicas, 17);

        this.frameRate = this.frameRate.bind(this);
        setInterval(this.frameRate, 160);

    } //cierra el constructor de bandera


    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



    pintar(suelo) {
        this.suelo = suelo;
        this.app.imageMode(this.app.CENTER);
  
        if (this.tipo == "Sign") this.app.image(this.poste, this.pos.x, this.pos.y-30, this.poste.width / 1.3, this.poste.height / 1.3);
        if (this.waves >= this.poste.length) this.waves = 0;
        if (this.tipo == "Flag") this.app.image(this.poste[this.waves], this.pos.x + 45, this.pos.y - 60, 120, 220);
    } //cierra el metodo pintar


    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


    fisicas() {


        this.vel.y += this.acel.y

        //aplica las fisicas a la posicion 

        this.pos.y += (this.app.int)(this.vel.y);

        for (let i = 0; i < this.suelo.length; i++) {

            let sue = this.suelo[i];

            //la bandera para si estÃ¡ pisando suelo
            if (this.vel.y >= 0 && (this.app.int)(this.pos.y + this.alto / 2) > sue.pos.y && (this.app.int)(this.pos.y + this.alto / 2) < sue.pos.y + 30 && this.pos.x - this.ancho / 2 <= sue.pos.x + sue.ancho && this.pos.x + this.ancho / 2 >= sue.pos.x) {
                this.vel.y = 0;
                this.pos.y = sue.pos.y - this.alto / 2;

            }
        }
    } //cierra el metodo fisica

    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    frameRate() {
        this.waves += 1;
    } //cierra el frameRate
} //cierra la clase bandera